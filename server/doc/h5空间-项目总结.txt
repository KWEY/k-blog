

此前的技术积累
专栏H5、大会员H5、挂件商城H5、风纪委&小黑屋H5、M站

以简单业务与非核心场景为主。

项目的时间线
2018年3月 ——— 空间H5项目启动，初次迭代上线时间预估为客户端5.26

开展了H5关键场景的技术方案show case：

h5长滚动
h5单页应用平滑切换
共有4人提供了不同的解决方案，以刘成与王廉明的方案表现较为突出，后续采纳为空间h5的技术方案。

2018年4月 ——— 相关基建离线包功能客户端5.26可调试

H5端RAIL体验指标

页面关键渲染时间<1.5s (wifi)
页面关键渲染时间<3s (3g)
帧动画>30fps (主流机型)
交互响应<100ms
支持常用手势，交互方式与app保持一致
无100ms以上阻塞方法
2018年4月 ——— 空间H5项目追加产品功能，并确认不随5.26发布，而是在5.26发布后才进测试

2018年5月 ——— 离线包项目验收发现两个问题：1.query丢失，2.webview内页面跳转需要用openScheme才能触发离线包

2018年5月 ——— 空间H5项目主要开发刘成离职，由王廉明接替

2018年6月 ——— 空间H5进入灰度阶段（1%），并追加了动态卡片相关需求。

动态项目上线 空间H5项目开始进入追赶动态的功能迭代周期 
产品侧的思路是功能持平后才能全量

2018年6月 ——— 离线包2期启动，主要功能为支持html文件离线

2018年7月 ——— 空间H5 二期功能迭代：大会员铭牌、追番、电商店铺等，并同步优化设计与产品提出的建议

ipad项目kick off
ipad空间需求全量以H5进行开发

2018年8月 ——— 以空间H5版本为基础进行ipad适配，后因设计方案反复，延至9月初启动。

2018年8月 ——— 空间H5页面接入离线包，离线包方案存在wk cookie问题，空间H5必须使用wk，进度受阻

2018年8月 ——— 空间H5三期功能迭代完成，灰度扩量（5%），新增专栏文集、动态抽奖、动态投票等

2018年9月 ——— 空间H5扩量后收到了卡顿的反馈，原有方案在加入了超长的动态和不确定的动态卡片高度变得不适用，进行了空间长列表滚动重构和tab切换的优化。

国际版项目kick off

国际版空间需求全量以H5进行开发

2018年10月 ——— 以空间H5为基础进行多语言适配

2018年10月 ——— 从空间H5项目中抽出动态tab进行组件化，方便后续活动使用。

性能优化工作重心从H5逐渐转移到webview本身

招聘到作为hybrid方向负责人的寸志，但3天后被挖走了

自己带领团队内同学进行webview方向的学习

2018年11月 ——— webview初始化到h5页面加载完成的端到端监控，客户端排期5.34

2018年12月 ——— 针对低端机型卡顿问题进行性能优化

2019年1月 ——— 空间H5灰度50%，收到了较多的返回主要集中在UI和交互方式不一致上，2天后回退到5%

双端8分位总白屏时间都维持在1.5s左右，反馈卡顿的用户较少，

主要集中在手势响应、滚动曲线、交互动画等细节上

2019年1月 ——— 针对用户反馈的问题逐一解决

2019年1月 ——— 提交 webview初始化阶段的优化需求，客户端排期5.38

此时前端能做的优化已经所剩无几，高端机端到端时间1s以内，

低端机的代表红米Note3 端到端时间为2.5s，与NA的体验仍有肉眼可见的差距。

2019年2月 ——— 继续功能迭代：播单、追影视、国际版多语言

2019年3月 ——— 评估短时间内无法突破低端机体验，做不到彻底全量覆盖，项目终止

项目运作中的关键问题
项目初期过于乐观，没有从用户的角度思考H5代替NA带来的体验问题。
测试因涉及端内jsbridge改造，因此部分需求需要和APP版本绑定
不涉及端内改造的需求也因为要进行回归，在早期的几个版本中需要夹在APP两个版本之间进行测试。
离线包、wkwebview、端到端性能监控等项目，由于缺少webview方面的了解，提需求时未能考虑周全，以至于需要跨客户端多个版本才能完善。
没有掌握好节奏，追赶动态的迭代、ipad、国际版耗费了大量的时间
在性能相关的测试工作中对低端机关注少，仅关注8分位值。
始终未能和APP开发形成很好的联动，一些对体验优化有较大效果的需求迟迟未能启动。
重来一次该如何改善
在选择用H5代替NA体验时要更谨慎思考可行性。
webview白屏的优化、ssr渲染、按机型、Uid灰度应该在第一个版本就上
组织虚拟项目组，由虚拟项目组共同承担目标，而不是一方推另外一方做事。
在方案设计的时候尽量参照业界现有成熟方案，避免重新设计重新踩坑。
招聘关键专家的力度要加强
开辟实验渠道，如近期的x5，能够让前端与移动端开发保持较快的迭代周期
低端机型的优化需要单独考虑，提供降级体验。
与移动端、产品经理一同明确项目目标，制定更有节奏的计划，避免在功能迭代与优化迭代中反复摇摆。
