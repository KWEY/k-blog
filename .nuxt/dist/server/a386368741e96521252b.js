exports.ids=[3],exports.modules={120:function(t,e,o){"use strict";o.r(e);var n=o(60),r=o(1),c=o(3),d={name:"Edit",head:()=>({title:"发布",script:[{src:r.a.editor}]}),beforeRouteEnter(t,e,o){o(t=>t.setData(e))},components:{toast:n.a},data:()=>({routeFrom:null,typeList:[],editor:null,timer:0,title:"",description:"",content:"",type:"001_002",toast:{}}),computed:{article(){return this.$store.state.article.article},userStatus(){return this.$store.state.user},authorId(){return this.article.author?this.article.author.id:""}},watch:{userStatus(){this.userStatus.isAdmin?(this.updateUser(),this.closeToast()):this.noSendTip()}},mounted(){this.$store.state.isMobile?this.$router.push("/"):this.updateUser()},methods:{setData(t){this.routeFrom=t},updateUser(){if(!this.userStatus.isAdmin)return void this.noSendTip();if(this.editor)return;const t=this.$store.state.typeList;t&&this.format(t),window.wangEditor?this.initEditor():this.timer=setInterval(()=>{this.initEditor()},400)},initEditor(){window.wangEditor&&(clearInterval(this.timer),this.editor=new window.wangEditor(this.$refs.editor),this.editor.customConfig.uploadImgShowBase64=!0,this.editor.customConfig.onchange=(html=>{this.content=html}),this.editor.create(),this.setArticle())},format(data){const t=data.list,e=[];t.forEach(t=>{"001"===t.tid&&Array.prototype.push.apply(e,t.list.slice(1))}),this.typeList=e},upload(){if(!this.userStatus.isAdmin)return void this.noSendTip();const t=this.$store.state.author&&this.$store.state.author._id;if(!(this.title&&this.description&&this.content&&t))return void this.showToast("输入“title、description、content、id”","warn",!0);const article=this.$store.state.article.article,data={title:this.title,author:t,id:article.id,description:this.description,type:[this.type],content:this.content,created_at:article.created_at};c.a.updateArticle(data).then(t=>{if(2===t.code)return this.showToast("恢复成功","success"),void setTimeout(()=>{this.editSuccess("/")},1e3);if(t.success)this.showToast("更新成功","success"),setTimeout(()=>{this.editSuccess()},1e3);else{const text=t.msg||"更新失败";this.showToast(text,"warn",!0)}})},showToast(content,t,e=!1){this.toast={type:t,content:content,showClose:e,show:!0,duration:1e3},e||setTimeout(()=>{this.toast.show=!1},this.toast.duration)},closeToast(){this.toast.show=!1},noSendTip(){this.showToast("当前角色无法上传文章","warn",!0)},setArticle(){const article=this.$store.state.article.article;this.content=article.content,this.title=article.title,this.type=article.type&&article.type[0].id,this.description=article.description,this.editor.txt.html(this.content)},editSuccess(t){"/register"===(t=t||this.routeFrom&&this.routeFrom.path||"/")&&(t="/"),this.$router.push(`${t}?edit=1`)}}},l=o(2);var component=Object(l.a)(d,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"kwe-json",attrs:{"data-id":t.authorId},on:{click:t.closeToast}},[t._ssrNode('<div class="kwe-json-title">',"</div>",[t._ssrNode('<div class="kwe-type">type: </div> '),o("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],staticClass:"kwe-type-input",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.type=e.target.multiple?o:o[0]}}},t._l(t.typeList,function(e){return o("option",{key:e.pid,domProps:{value:e.pid}},[t._v(t._s(e.name))])}),0),t._ssrNode(' <div class="kwe-title">title: </div> <input type="text"'+t._ssrAttr("value",t.title)+' class="kwe-title-input">')],2),t._ssrNode(' <div class="kwe-json-description"><div class="kwe-description">description: </div> <input type="text"'+t._ssrAttr("value",t.description)+' class="kwe-description-input"></div> <div class="kwe-json-content"><p class="kwe-content">content: <span class="kwe-upload">上传</span></p> <div class="kwe-content-input"></div></div> '),o("toast",{attrs:{show:t.toast.show,content:t.toast.content,close:t.toast.showClose,type:t.toast.type},on:{close:t.closeToast}})],2)},[],!1,function(t){var e=o(80);e.__inject__&&e.__inject__(t)},null,"de743b5c");e.default=component.exports},57:function(t,e,o){var content=o(59);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var n=o(5).default;t.exports.__inject__=function(t){n("3b75bc58",content,!0,t)}},58:function(t,e,o){"use strict";o.r(e);var n=o(57),r=o.n(n);for(var c in n)"default"!==c&&function(t){o.d(e,t,function(){return n[t]})}(c);e.default=r.a},59:function(t,e,o){(t.exports=o(4)(!1)).push([t.i,".eui-toast{position:fixed;z-index:999999;line-height:17px}.eui-toast--default{left:50%;transform:translate(-50%);bottom:80px}.eui-toast--center{top:50%}.eui-toast--center,.eui-toast--top{left:50%;transform:translate(-50%,-50%)}.eui-toast--top{top:80px}.eui-toast-message{min-width:200px;max-width:600px;padding:12px 50px 12px 20px;font-size:14px;text-align:center;color:#fff;border-radius:6px;opacity:.9}.eui-toast-message img{margin-bottom:8px}.eui-toast-message.eui-toast-success{background:#f0f9eb;border:1px solid #e1f3d8;color:#67c23a}.eui-toast-message.eui-toast-warn{background:#fdf6ec;color:#e6a23c}.eui-toast-message.eui-toast-tip{background:#edf2fc;color:#909399}.eui-toast-message.eui-toast-error{background:#fef0f0;color:#f56c6c}.eui-toast-message .eui-toast-close{display:inline-block;position:absolute;right:4px;bottom:6px;width:30px;height:30px;border-radius:50%;background:rgba(0,0,0,.1);font-size:20px;line-height:26px;text-align:center;cursor:pointer}.eui-toast-message .eui-toast-close:hover{color:#000}.eui-fade-enter{opacity:0}.eui-fade-enter-active,.eui-fade-leave-active{transition:opacity .4s}.eui-fade-leave-active{opacity:0}",""])},60:function(t,e,o){"use strict";var n={name:"Toast",props:{show:{type:Boolean,default:!1},content:{type:String,default:""},type:{type:String,default:""},close:{type:Boolean,default:!1},location:{type:String,default:"center"}},data:()=>({toastStyle:{},imgStyle:{},path:""}),computed:{currentStyle(){let style="eui-toast--center";switch(this.location){case"bottom":style="eui-toast--default";break;case"top":style="eui-toast--top"}return style},textStyle(){return`eui-toast-${this.type}`}},mounted(){const t=()=>{this.closed()};window.addEventListener("hashchange",t),window.addEventListener("popstate",t),window.addEventListener("pagehide",t)},methods:{closed(){this.$emit("close")}}},r=o(2);var component=Object(r.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"eui-fade"}},[t.show?o("div",{staticClass:"eui-toast",class:t.currentStyle},[o("div",{staticClass:"eui-toast-message",class:t.textStyle,style:t.toastStyle},[t.path?o("img",{style:t.imgStyle,attrs:{src:t.path,alt:""}}):t._e(),t._v(" "),o("div",[t._v("\n        "+t._s(t.content)+"\n        "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.close,expression:"close"}],staticClass:"eui-toast-close",on:{click:t.closed}},[t._v("x")])])])]):t._e()])},[],!1,function(t){var e=o(58);e.__inject__&&e.__inject__(t)},null,"4ff8dd89");e.a=component.exports},61:function(t,e,o){var content=o(81);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);var n=o(5).default;t.exports.__inject__=function(t){n("7d93f130",content,!0,t)}},80:function(t,e,o){"use strict";o.r(e);var n=o(61),r=o.n(n);for(var c in n)"default"!==c&&function(t){o.d(e,t,function(){return n[t]})}(c);e.default=r.a},81:function(t,e,o){(t.exports=o(4)(!1)).push([t.i,".kwe-json{width:800px;margin:0 auto;padding-top:20px;font-size:14px;line-height:1.5}.kwe-json .kwe-title,.kwe-json .kwe-type{width:60px}.kwe-json .kwe-content,.kwe-json .kwe-description,.kwe-json .kwe-title,.kwe-json .kwe-type{text-align:left;font-size:16px;line-height:40px}.kwe-json .kwe-type-input{display:inline-block;width:80px;background:transparent;border-color:#00a1d6;outline:none}.kwe-json .kwe-content-input .w-e-toolbar{background:transparent!important;border-color:#00a1d6!important}.kwe-json .kwe-content-input .w-e-text-container{height:600px!important;border-color:#00a1d6!important}.kwe-json .kwe-content-input .w-e-text{overflow-y:auto!important}.kwe-json-title{display:-ms-flexbox;display:flex;padding-top:20px;line-height:40px}.kwe-json .kwe-description-input,.kwe-json .kwe-title-input{display:block;width:100%;padding:2px;box-sizing:border-box;height:40px;border:1px solid #00a1d6;background:transparent;font-size:16px;border-radius:4px;outline:none}.kwe-json .kwe-description-input{font-size:14px}.kwe-json .kwe-upload{float:right;display:block;width:100px;font-size:18px;line-height:40px;text-align:center;border-radius:4px;cursor:pointer;z-index:2}.kwe-json .kwe-upload:hover{color:#000}",""])}};