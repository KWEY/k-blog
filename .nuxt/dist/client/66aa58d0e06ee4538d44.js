(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{202:function(t,e,o){var content=o(205);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(16).default)("3b75bc58",content,!0,{sourceMap:!1})},204:function(t,e,o){"use strict";var n=o(202);o.n(n).a},205:function(t,e,o){(t.exports=o(15)(!1)).push([t.i,".eui-toast{position:fixed;z-index:999999;line-height:17px}.eui-toast--default{left:50%;transform:translate(-50%);bottom:80px}.eui-toast--center{top:50%}.eui-toast--center,.eui-toast--top{left:50%;transform:translate(-50%,-50%)}.eui-toast--top{top:80px}.eui-toast-message{min-width:200px;max-width:600px;padding:12px 50px 12px 20px;font-size:14px;text-align:center;color:#fff;border-radius:6px;opacity:.9}.eui-toast-message img{margin-bottom:8px}.eui-toast-message.eui-toast-success{background:#f0f9eb;border:1px solid #e1f3d8;color:#67c23a}.eui-toast-message.eui-toast-warn{background:#fdf6ec;color:#e6a23c}.eui-toast-message.eui-toast-tip{background:#edf2fc;color:#909399}.eui-toast-message.eui-toast-error{background:#fef0f0;color:#f56c6c}.eui-toast-message .eui-toast-close{display:inline-block;position:absolute;right:4px;bottom:6px;width:30px;height:30px;border-radius:50%;background:rgba(0,0,0,.1);font-size:20px;line-height:26px;text-align:center;cursor:pointer}.eui-toast-message .eui-toast-close:hover{color:#000}.eui-fade-enter{opacity:0}.eui-fade-enter-active,.eui-fade-leave-active{transition:opacity .4s}.eui-fade-leave-active{opacity:0}",""])},208:function(t,e,o){"use strict";var n={name:"Toast",props:{show:{type:Boolean,default:!1},content:{type:String,default:""},type:{type:String,default:""},close:{type:Boolean,default:!1},location:{type:String,default:"center"}},data:function(){return{toastStyle:{},imgStyle:{},path:""}},computed:{currentStyle:function(){var style="eui-toast--center";switch(this.location){case"bottom":style="eui-toast--default";break;case"top":style="eui-toast--top"}return style},textStyle:function(){return"eui-toast-".concat(this.type)}},mounted:function(){var t=this,e=function(){t.closed()};window.addEventListener("hashchange",e),window.addEventListener("popstate",e),window.addEventListener("pagehide",e)},methods:{closed:function(){this.$emit("close")}}},r=(o(204),o(6)),component=Object(r.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"eui-fade"}},[t.show?o("div",{staticClass:"eui-toast",class:t.currentStyle},[o("div",{staticClass:"eui-toast-message",class:t.textStyle,style:t.toastStyle},[t.path?o("img",{style:t.imgStyle,attrs:{src:t.path,alt:""}}):t._e(),t._v(" "),o("div",[t._v("\n        "+t._s(t.content)+"\n        "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.close,expression:"close"}],staticClass:"eui-toast-close",on:{click:t.closed}},[t._v("x")])])])]):t._e()])},[],!1,null,null,null);e.a=component.exports},209:function(t,e,o){var content=o(229);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(16).default)("7d93f130",content,!0,{sourceMap:!1})},228:function(t,e,o){"use strict";var n=o(209);o.n(n).a},229:function(t,e,o){(t.exports=o(15)(!1)).push([t.i,".kwe-json{width:800px;margin:0 auto;padding-top:20px;font-size:14px;line-height:1.5}.kwe-json .kwe-title,.kwe-json .kwe-type{width:60px}.kwe-json .kwe-content,.kwe-json .kwe-description,.kwe-json .kwe-title,.kwe-json .kwe-type{text-align:left;font-size:16px;line-height:40px}.kwe-json .kwe-type-input{display:inline-block;width:80px;background:transparent;border-color:#00a1d6;outline:none}.kwe-json .kwe-content-input .w-e-toolbar{background:transparent!important;border-color:#00a1d6!important}.kwe-json .kwe-content-input .w-e-text-container{height:600px!important;border-color:#00a1d6!important}.kwe-json .kwe-content-input .w-e-text{overflow-y:auto!important}.kwe-json-title{display:-ms-flexbox;display:flex;padding-top:20px;line-height:40px}.kwe-json .kwe-description-input,.kwe-json .kwe-title-input{display:block;width:100%;padding:2px;box-sizing:border-box;height:40px;border:1px solid #00a1d6;background:transparent;font-size:16px;border-radius:4px;outline:none}.kwe-json .kwe-description-input{font-size:14px}.kwe-json .kwe-upload{float:right;display:block;width:100px;font-size:18px;line-height:40px;text-align:center;border-radius:4px;cursor:pointer;z-index:2}.kwe-json .kwe-upload:hover{color:#000}",""])},272:function(t,e,o){"use strict";o.r(e);o(18);var n=o(208),r=o(3),c=o(4),l={name:"Edit",head:function(){return{title:"发布",script:[{src:r.a.editor}]}},beforeRouteEnter:function(t,e,o){o(function(t){return t.setData(e)})},components:{toast:n.a},data:function(){return{routeFrom:null,typeList:[],editor:null,timer:0,title:"",description:"",content:"",type:"001_002",toast:{}}},computed:{article:function(){return this.$store.state.article.article},userStatus:function(){return this.$store.state.user},authorId:function(){return this.article.author?this.article.author.id:""}},watch:{userStatus:function(){this.userStatus.isAdmin?(this.updateUser(),this.closeToast()):this.noSendTip()}},mounted:function(){this.$store.state.isMobile?this.$router.push("/"):this.updateUser()},methods:{setData:function(t){this.routeFrom=t},updateUser:function(){var t=this;if(this.userStatus.isAdmin){if(!this.editor){var e=this.$store.state.typeList;e&&this.format(e),window.wangEditor?this.initEditor():this.timer=setInterval(function(){t.initEditor()},400)}}else this.noSendTip()},initEditor:function(){var t=this;window.wangEditor&&(clearInterval(this.timer),this.editor=new window.wangEditor(this.$refs.editor),this.editor.customConfig.uploadImgShowBase64=!0,this.editor.customConfig.onchange=function(html){t.content=html},this.editor.create(),this.setArticle())},format:function(data){var t=data.list,e=[];t.forEach(function(t){"001"===t.tid&&Array.prototype.push.apply(e,t.list.slice(1))}),this.typeList=e},upload:function(){var t=this;if(this.userStatus.isAdmin){var e=this.$store.state.author&&this.$store.state.author._id;if(this.title&&this.description&&this.content&&e){var article=this.$store.state.article.article,data={title:this.title,author:e,id:article.id,description:this.description,type:[this.type],content:this.content,created_at:article.created_at};c.a.updateArticle(data).then(function(e){if(2===e.code)return t.showToast("恢复成功","success"),void setTimeout(function(){t.editSuccess("/")},1e3);if(e.success)t.showToast("更新成功","success"),setTimeout(function(){t.editSuccess()},1e3);else{var text=e.msg||"更新失败";t.showToast(text,"warn",!0)}})}else this.showToast("输入“title、description、content、id”","warn",!0)}else this.noSendTip()},showToast:function(content,t){var e=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.toast={type:t,content:content,showClose:o,show:!0,duration:1e3},o||setTimeout(function(){e.toast.show=!1},this.toast.duration)},closeToast:function(){this.toast.show=!1},noSendTip:function(){this.showToast("当前角色无法上传文章","warn",!0)},setArticle:function(){var article=this.$store.state.article.article;this.content=article.content,this.title=article.title,this.type=article.type&&article.type[0].id,this.description=article.description,this.editor.txt.html(this.content)},editSuccess:function(t){"/register"===(t=t||this.routeFrom&&this.routeFrom.path||"/")&&(t="/"),this.$router.push("".concat(t,"?edit=1"))}}},d=(o(228),o(6)),component=Object(d.a)(l,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"kwe-json",attrs:{"data-id":t.authorId},on:{click:t.closeToast}},[o("div",{staticClass:"kwe-json-title"},[o("div",{staticClass:"kwe-type"},[t._v("type: ")]),t._v(" "),o("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],staticClass:"kwe-type-input",on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.type=e.target.multiple?o:o[0]}}},t._l(t.typeList,function(e){return o("option",{key:e.pid,domProps:{value:e.pid}},[t._v(t._s(e.name))])}),0),t._v(" "),o("div",{staticClass:"kwe-title"},[t._v("title: ")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.title,expression:"title",modifiers:{trim:!0}}],staticClass:"kwe-title-input",attrs:{type:"text"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),o("div",{staticClass:"kwe-json-description"},[o("div",{staticClass:"kwe-description"},[t._v("description: ")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.description,expression:"description",modifiers:{trim:!0}}],staticClass:"kwe-description-input",attrs:{type:"text"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),o("div",{staticClass:"kwe-json-content"},[o("p",{staticClass:"kwe-content"},[t._v("content: "),o("span",{staticClass:"kwe-upload",on:{click:function(e){return e.stopPropagation(),t.upload(e)}}},[t._v("上传")])]),t._v(" "),o("div",{ref:"editor",staticClass:"kwe-content-input"})]),t._v(" "),o("toast",{attrs:{show:t.toast.show,content:t.toast.content,close:t.toast.showClose,type:t.toast.type},on:{close:t.closeToast}})],1)},[],!1,null,null,null);e.default=component.exports}}]);